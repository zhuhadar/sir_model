<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
  <title>To SIR, with Love</title>
  
  <meta property="description" itemprop="description" content="A brief introduction to the SIR model and what is tells us about the spread of COVID-19."/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2020-05-12"/>
  <meta property="article:created" itemprop="dateCreated" content="2020-05-12"/>
  <meta name="article:author" content="Michael D. Porter"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="To SIR, with Love"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A brief introduction to the SIR model and what is tells us about the spread of COVID-19."/>
  <meta property="og:image" content="https://mdporter.github.io/blog/to-sir-with-love_files/figure-html5/unnamed-chunk-1-1.png"/>
  <meta property="og:image:width" content="576"/>
  <meta property="og:image:height" content="96"/>
  <meta property="og:locale" content="en_US"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary_large_image"/>
  <meta property="twitter:title" content="To SIR, with Love"/>
  <meta property="twitter:description" content="A brief introduction to the SIR model and what is tells us about the spread of COVID-19."/>
  <meta property="twitter:image" content="https://mdporter.github.io/blog/to-sir-with-love_files/figure-html5/unnamed-chunk-1-1.png"/>
  <meta property="twitter:image:width" content="576"/>
  <meta property="twitter:image:height" content="96"/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","base_url","repository_url","output"]}},"value":[{"type":"character","attributes":{},"value":["To SIR, with Love"]},{"type":"character","attributes":{},"value":["A brief introduction to the SIR model and what is tells us about the spread of COVID-19.  \n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Michael D. Porter"]},{"type":"character","attributes":{},"value":["https://faculty.virginia.edu/mdporter/"]}]}]},{"type":"character","attributes":{},"value":["05-12-2020"]},{"type":"character","attributes":{},"value":["https://mdporter.github.io/blog/"]},{"type":"character","attributes":{},"value":["https://github.com/mdporter/blog"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["to-sir-with-love_files/figure-html5/animation-1.gif","to-sir-with-love_files/figure-html5/SIR-tplot-1.png","to-sir-with-love_files/figure-html5/SIR-transition-1.png","to-sir-with-love_files/figure-html5/unnamed-chunk-1-1.png","to-sir-with-love_files/figure-html5/unnamed-chunk-10-1.png","to-sir-with-love_files/figure-html5/unnamed-chunk-3-1.png","to-sir-with-love_files/figure-html5/unnamed-chunk-5-1.png","to-sir-with-love_files/figure-html5/unnamed-chunk-7-1.png","to-sir-with-love_files/figure-html5/unnamed-chunk-8-1.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for table of contents */
  
  .d-toc {
    color: rgba(0,0,0,0.8);
    font-size: 0.8em;
    line-height: 1em;
  }
  
  .d-toc-header {
    font-size: 0.6rem;
    font-weight: 400;
    color: rgba(0, 0, 0, 0.5);
    text-transform: uppercase;
    margin-top: 0;
    margin-bottom: 1.3em;
  }
  
  .d-toc a {
    border-bottom: none;
  }
  
  .d-toc ul {
    padding-left: 0;
  }
  
  .d-toc li>ul {
    padding-top: 0.8em;
    padding-left: 16px;
    margin-bottom: 0.6em;
  }
  
  .d-toc ul,
  .d-toc li {
    list-style-type: none;
  }
  
  .d-toc li {
    margin-bottom: 0.9em;
  }
  
  .d-toc-separator {
    margin-top: 20px;
    margin-bottom: 2em;
  }
  
  .d-article-with-toc {
    border-top: none;
    padding-top: 0;
  }
  
  
  
  /* Tweak code blocks (note that this CSS is repeated above in an injection
     into the d-code shadow dom) */
  
  d-code {
    overflow-x: auto !important;
  }
  
  pre.d-code code.d-code {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  pre.text-output {
  
    font-size: 12px;
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  @media(min-width: 768px) {
  
  d-code {
    overflow-x: visible !important;
  }
  
  pre.d-code code.d-code  {
      padding-left: 18px;
      font-size: 14px;
  }
  pre.text-output {
    font-size: 14px;
  }
  }
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // create d-bibliography
    var bibliography = $('<d-bibliography></d-bibliography>');
    $('#distill-bibliography').wrap(bibliography);
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace citations with <d-cite>
    $('.citation').each(function(i, val) {
      appendix = true;
      var cites = $(this).attr('data-cites').split(" ");
      var dt_cite = $('<d-cite></d-cite>');
      dt_cite.attr('key', cites.join());
      $(this).replaceWith(dt_cite);
    });
    // remove refs
    $('#refs').remove();
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-toc a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // replace code blocks with d-code
    $('pre>code').each(function(i, val) {
      var code = $(this);
      var pre = code.parent();
      var clz = "";
      var language = pre.attr('class');
      if (language) {
        // map unknown languages to "clike" (without this they just dissapear)
        if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                                 "javascript", "js", "julia", "lua", "markdown",
                                 "markup", "mathml", "python", "svg", "xml"]) == -1)
          language = "clike";
        language = ' language="' + language + '"';
        var dt_code = $('<d-code block' + language + clz + '></d-code>');
        dt_code.text(code.text());
        pre.replaceWith(dt_code);
      } else {
        code.addClass('text-output').unwrap().changeElementType('pre');
      }
    });
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('d-code, pre.text-output, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // table of contents
      if (have_authors) // adjust border if we are in authors
        $('.d-toc').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
      $('d-code').each(function(i, val) {
        var style = document.createElement('style');
        style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                          '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
        if (this.shadowRoot)
          this.shadowRoot.appendChild(style);
      });
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-toc-header').remove();
    $('.d-toc').remove();
    $('.d-toc-separator').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="to-sir-with-love_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="to-sir-with-love_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="to-sir-with-love_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="to-sir-with-love_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"To SIR, with Love","description":"A brief introduction to the SIR model and what is tells us about the spread of COVID-19.","authors":[{"author":"Michael D. Porter","authorURL":"https://faculty.virginia.edu/mdporter/","affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2020-05-12T00:00:00.000-04:00","citationText":"Porter, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>To SIR, with Love</h1>
<p><p>A brief introduction to the SIR model and what is tells us about the spread of COVID-19.</p></p>
</div>

<div class="d-byline">
  Michael D. Porter <a href="https://faculty.virginia.edu/mdporter/" class="uri">https://faculty.virginia.edu/mdporter/</a> 
  
<br/>05-12-2020
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 id="introduction">Introduction</h1>
<blockquote>
Pay attention a minute everybody, I’ve got an announcement to make. It’s about SIR.
<footer>
Bert Denham, “To Sir, with Love”
</footer>
</blockquote>
<p>Ok, ok, I know. Sir, played by Sidney Poitier in the classic movie, <a href="https://en.wikipedia.org/wiki/To_Sir,_with_Love">To Sir, with Love</a> is not the same as the S-I-R epidemiological model. But I needed a catchy title, and this was the first thing that popped into my head. It’s been a long time since I watched the movie, but I remember it being about a teacher who is able to reform his class of deviant youths. I don’t know if the following explanation will lead to a youth reform movement, but who knows? We are all stuck at home, and by this time you are probably thinking that your kid’s teacher was lying when they told you your child was a pleasure to have in class; so give it a try, maybe SIR will change your life too.</p>
<h1 id="sir">SIR</h1>
<p>The SIR model is one of the most basic models for describing the temporal dynamics of an infectious disease in a population. It compartmentalizes people into one of three categories: those who are <font color="#377eb8">Susceptible</font> to the disease, those who are currently <font color="#e41a1c">Infectious</font>, and those who have <font color="#4daf4a">Recovered</font> (with immunity). At its most basic level, the SIR model is a set of equations that describes the number (or proportion) of people in each compartment at every point in time. The SIR model is often represented with the following flow diagram that shows the three states (S, I, and R) and arrows depicting the direction of flow between the states.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/unnamed-chunk-1-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<p>At this point in the pandemic, you may have seen the usual graphical output from a SIR model that shows the number (or proportion) of people in each state over time</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/SIR-tplot-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<p>These curves come from the (continuous time) SIR model which specifies a set of three ordinary differential equations:</p>
<p><span class="math display">\[
\frac{d S_t}{dt} = -\frac{\beta I_t S_t}{N}, \qquad \frac{d I_t}{dt} = \frac{\beta I_t S_t}{N} - \gamma I_t, \qquad \frac{d R_t}{dt} = \gamma I_t
\]</span></p>
<p>Do I need to say more? As the saying goes,“An equation is worth a thousand words”. But for reader who would rather look at pictures than equations, I’ll try to make these equations a bit more understandable (in less than 1000 words).</p>
<h2 id="unpacking-sir">Unpacking SIR</h2>
<p>Instead of diving straight into the equations, let’s dip our toes in the water and think about how an epidemic works from the first infection. At the very beginning, a contagious person enters a population full of susceptible people. Unless they are quarantined, they move about in the population potentially infecting some of the susceptible population. The SIR model is not very sophisticated in how it models the interactions between members of a population. It assumes the infected people can mix with anyone in the population with equal likelihood; there are no geographic, demographic, or other factors that separate members of a real population. <!-- It also treats all infectious people the same ... too sick, ... --> <!-- It models the interaction between infected and susceptible people with a (uniform) random process.  --> Every day a contagious person will randomly move around the population infecting any susceptible person they come into close enough contact with. Let’s say a contagious person will come into close contact with (and cough on, sneeze on, kiss, etc.) an average of <span class="math inline">\(\beta\)</span> (<em>beta</em>) people each day; if those people are susceptible (i.e., not immune) they will become infected otherwise they will just benefit from the close contact. If there are <span class="math inline">\(S_t\)</span> susceptible people on day <span class="math inline">\(t\)</span>, the expected number infected by our carrier is <span class="math inline">\(\beta S_t / N\)</span>, where <span class="math inline">\(S_t/N\)</span> is the probability a close contact is with a susceptible person.</p>
<p>Our infectious carrier will continue this process of randomly contacting people each day until they are no longer contagious (either by recovery or death). Suppose that every day a contagious person has probability <span class="math inline">\(\gamma\)</span> (<em>gamma</em>) of becoming non-contagious. Some readers will recognize that this specifies a <a href="https://en.wikipedia.org/wiki/Geometric_distribution"><em>geometric distribution</em></a> for the length of time an infected person is contagious. One property of this model is that the average number of days that someone stays contagious is <span class="math inline">\(1/\gamma\)</span>.</p>
<p>Notice that we have specified two model parameters: <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>. Because these are greek letters you know they are important! Combined, they make another parameter you may have heard of, the <span class="math inline">\(R_0\)</span> (“R nought”). The <span class="math inline">\(R_0\)</span>, known as the <a href="https://en.wikipedia.org/wiki/Basic_reproduction_number">basic reproductive number</a>, is defined as the expected number of people infected from a contagious person over the length of their contagiousness (in a fully susceptible population). If you were paying attention and keeping notes, you may be able to work out that <span class="math inline">\(R_0 = \beta/\gamma\)</span> which is the expected number of close contacts per day (<span class="math inline">\(\beta\)</span>) multiplied by the average number of days contagious (<span class="math inline">\(1/\gamma\)</span>). If <span class="math inline">\(R_0 &gt; 1\)</span> (or equivalently, <span class="math inline">\(\beta &gt; \gamma\)</span>), then we will likely have an epidemic on our hands as each infected person will infect more than one other on average, who will infect more than one other, and so on (i.e., exponential growth) until we reach herd immunity (but more on that later).</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/animation-1.gif" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p>“But what about those equations”, you ask. And I’m glad you asked because math is fun! So far we have described how one contagious person moves through the system randomly infecting people each day until they are no longer contagious. But now let’s bring in the dynamics since we are all in this together (literally). Refer back to the SIR ODE equations, they describe the <em>change</em> in counts at an instance of time. We can consider a discrete time version of these equations that describe the changes each day using the concepts described above. I should note that this will give an approximation of the actual SIR output (and there are better approximations then the one described below). However, don’t let this disrupt your sleep; remember that the SIR model is only an approximation of reality and a discrete time perspective is, in my opinion, a better representation than continuous time (e.g., humans don’t randomly mix for 24 hours each day, data is reported daily, etc). Also keep in mind that the model parameters must be estimated, so the fitted curve for the discrete time version should be similar to the continuous time version (even if the estimated parameter values are slightly different).</p>
<p>For notation, take <span class="math inline">\(S_t, I_t, R_t\)</span> as the number of Susceptible, Infectious, and Removed people in the population on day <span class="math inline">\(t\)</span>. The total population size <span class="math inline">\(N\)</span> is assumed to stay constant over the observation period and is equal to the sum of all counts (i.e., <span class="math inline">\(N = S_t + I_t + R_t\)</span>). This discrete time version of the SIR model specifies the equations: <span class="math display">\[
 S_{t+1} - S_t = -\frac{\beta I_t S_t}{N}, \qquad I_{t+1} - I_t = \frac{\beta I_t S_t}{N} - \gamma I_t, \qquad R_{t+1} - R_t = \gamma I_t
\]</span> This shows that the three SIR equations describe how the counts in each category change in one day. Consider the change in the number of infectious; it is the sum of two components: <span class="math display">\[
\begin{align}
I_{t+1} - I_t &amp;= \text{newly infectious} - \text{removed} \\
&amp;= \frac{\beta I_t S_t}{N} - \gamma I_t \\
&amp;= I_t \left(\beta S_t/N - \gamma \right)
\end{align}
\]</span> The last line makes clear that this term just multiplies what we described above for a single infectious person by <span class="math inline">\(I_t\)</span>, the total number of infectious people at time <span class="math inline">\(t\)</span>. In other words, if <em>one</em> infectious person is expected to infect <span class="math inline">\(\beta S_t / N\)</span> other people on day <span class="math inline">\(t\)</span>, then <span class="math inline">\(I_t\)</span> infectious people are expected to infect <span class="math inline">\(I_t \cdot (\beta S_t / N)\)</span> on day <span class="math inline">\(t\)</span>. Likewise, if each infectious person has probability <span class="math inline">\(\gamma\)</span> of recovery or death on day <span class="math inline">\(t\)</span>, then the expected total number of infected people that recover (or die) on day <span class="math inline">\(t\)</span> is <span class="math inline">\(I_t \gamma\)</span>.</p>
<p>We can also examine the first term, corresponding to the number of newly infectious people, with a slightly different formulation <span class="math display">\[
\begin{align}
\text{newly infectious}  &amp;= \left(\frac{\beta I_t}{N}\right) S_t \\
&amp;= f_t S_t
\end{align}
\]</span> As a reminder, <span class="math inline">\(\beta\)</span> is the <em>transmission parameter</em> and it controls the rate that infectious people can spread the disease (larger values of <span class="math inline">\(\beta\)</span> imply faster spread). The second line makes it explicit that the number of newly infected people at time <span class="math inline">\(t+1\)</span> is proportional to the number of susceptible people at time <span class="math inline">\(t\)</span>. Specifically, <span class="math inline">\(f_t=\beta I_t /N\)</span> is referred to as the <em>force of infection</em> and is the <em>fraction of susceptible people who become infectious during time t</em>. Notice that <span class="math inline">\(f_t\)</span> depends on both the transmission parameter <span class="math inline">\(\beta\)</span> and the proportion of people who are infectious at time <span class="math inline">\(t\)</span>.</p>
<p>The second term in the equation for the change in infectious people models the number of infectious people that are removed (i.e., recover with immunity or die): <span class="math display">\[
\begin{align}
\text{removed}  &amp;= \gamma I_t
\end{align}
\]</span> The <span class="math inline">\(\gamma \in [0,1]\)</span> parameter is the fraction of infectious people that are removed each day. When <span class="math inline">\(\gamma\)</span> is large, people will recover (or die) quickly and won’t have as much time to infect the susceptible population. However when <span class="math inline">\(\gamma\)</span> is small, people stay infectious longer and have more opportunity to infect others. Because this model is based on expected values, we can consider the separation of <span class="math inline">\(\gamma\)</span> into two sub-components to handle deaths and recoveries separately (e.g., <span class="math inline">\(\gamma = p_{\text{death}} \gamma_{\text{death}} + (1-p_{\text{death}})\gamma_{\text{recovery}}\)</span>).</p>
<p>If you look back at the SIR equations you’ll notice that the change in susceptibles and removed are based on the two components we just described. That is, the change in susceptibles is minus the number of newly infected and the change in removed is the number of newly recovered. This ensures that total number of people in all bins is always equal to <span class="math inline">\(N\)</span>.</p>
<p>For the visually inclined, here is my attempt to represent the flow of counts between times <span class="math inline">\(t\)</span> and <span class="math inline">\(t+1\)</span>. The equations above the arrows show the fraction of the counts in the left side bin that get transferred to the right side bin with color indicating if the count is positive (black) or negative (red).</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/SIR-transition-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<p>Notice that the flow out of each bin must sum to 1 to preserve the required property that total counts must equal the population size. Look now at the bins on the right side. Because <span class="math inline">\(S_{t+1}\)</span> only gets a negative flow it will only decrease (or stay the same) over time. The number of removed at time <span class="math inline">\(t+1\)</span>, <span class="math inline">\(R_{t+1}\)</span> only gets positive flow and will only increase (or stay the same) over time. The situation for the number of infectious, <span class="math inline">\(I_{t+1}\)</span> is different in that it can increase or decrease over time.</p>
<p>Hopefully this provides you with a little better understanding of the SIR model. It also reveals that the quote is wrong - an equation must be worth <em>more than</em> 1000 words since I have probably reached that limit and still have a few more things to say about herd immunity and <span class="math inline">\(R_0\)</span>.</p>
<h2 id="make-it-stop-herd-immunity-and-r_0">Make it stop: Herd Immunity and <span class="math inline">\(R_0\)</span></h2>
<p>Let’s concentrate on the number of infectious individuals and write out explicitly the estimate for time <span class="math inline">\(t+1\)</span>: <span class="math display">\[
\begin{align}
I_{t+1} &amp;= I_t + \left(\frac{\beta I_t}{N}\right) S_t - \gamma I_t \\
&amp;= I_t \left(1 + \beta\frac{S_t}{N}  - \gamma \right)
\end{align}
\]</span> This shows that <span class="math inline">\(I_{t+1}\)</span>, the number of infectious tomorrow, can be expressed as a multiple of the number of infectious today. This leads to the following conditions that determine if the number of infections is increasing, decreasing, or at its peak based on the two model parameters <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> as well as the proportion of the population that is susceptible <span class="math inline">\(S_t/N\)</span>. <span class="math display">\[
\begin{alignat}{2}
\beta\frac{ S_t}{N} \; &amp;&gt; \; \gamma \qquad &amp;&amp;\text{Infectious Count Increasing} \\
\beta\frac{ S_t}{N} \; &amp;= \; \gamma \qquad &amp;&amp;\text{Peak Infectious Count} \\
\beta\frac{ S_t}{N}   \; &amp;&lt; \; \gamma \qquad &amp;&amp;\text{Infectious Count Decreasing} 
\end{alignat}
\]</span></p>
<p>The peak of the epidemic will occur when the proportion of susceptible people is equal to the ratio <span class="math inline">\(\gamma/\beta\)</span> <span class="math display">\[
\begin{align}
\frac{ S_t}{N} &amp;= \frac{\gamma}{\beta} = \frac{1}{R_0} \qquad \text{Peak Conditions}
\end{align}
\]</span> which shows one reason <span class="math inline">\(R_0 = \beta/\gamma\)</span>, the “R nought” value mentioned above, is a prominent part of the discussion.</p>
<p>Let’s examine this in more detail. According to the SIR model, the peak of the infection, that is the day when the number of infected people is greatest, is the first day when the proportion of susceptible peoples fall below <span class="math inline">\(1/R_0\)</span>. Equivalently, this suggests the <em>epidemic will peak when the cumulative proportion of the population that has been infected exceeds</em> <span class="math inline">\(1-1/R_0\)</span>. This is what is meant by the term <em>herd immunity</em> - when the fraction of the population that is immune reaches a large enough level that the number infected starts to decline.</p>
<p>A recent <a href="https://coronavirus.jhu.edu/from-our-experts/early-herd-immunity-against-covid-19-a-dangerous-misconception">post by epidemiologists at Johns Hopkins University</a> suggests that the US is not close to herd immunity. Below is a plot that shows, according to the SIR model, the percentage of a population that needs to be immune before it reaches herd immunity for a given <span class="math inline">\(R_0\)</span> value.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p>The Johns Hopkins article suggests about 70% of the US needs to be immune to reach herd immunity; this would put <span class="math inline">\(R_0= 3.33\)</span>. There are all sorts of estimates on <span class="math inline">\(R_0\)</span> for COVID-19, but most that I have seen range between 1.5 and 6.5 (which will of course vary region to region and over time).</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="dynamics">Changing the disease dynamics</h2>
<p>Now that you know something of the SIR model, it can be insightful to consider how the dynamics change under different strategies. Here are three things a population may consider doing to limit the number of peopled infected with COVID-19</p>
<ol type="1">
<li>Reduce the transmission rate (decrease <span class="math inline">\(\beta\)</span>)</li>
<li>Reduce the length of time that someone is contagious (increase <span class="math inline">\(\gamma\)</span>)</li>
<li>Reduce the number of susceptible people (decrease <span class="math inline">\(S_1\)</span>)</li>
</ol>
<p>Below is a plot that shows how the infection dynamics are impacted under each strategy. The left facet shows the percentage of the population that is infectious (<span class="math inline">\(I_t/N\)</span>) and the right facet gives the percentage of population that has been infected (<span class="math inline">\((I_t + R_t)/N\)</span>). The baseline model uses <span class="math inline">\(\beta=0.30, \gamma=1/10\)</span> (<span class="math inline">\(R_0 = 3.0\)</span>) in a population of 100,000 people. This implies that each infectious individual will come into contagiously close contact with an average of 0.30 people per day and will stay contagious for an average of 10 days. On day 1, there is a single infectious person leaving <span class="math inline">\(S_1=99{,}999\)</span> susceptible, and <span class="math inline">\(R_1=0\)</span> recovered. Strategy 1 reduces <span class="math inline">\(\beta=0.25\)</span>, Strategy 2 increases <span class="math inline">\(\gamma=1/8\)</span> (contagious for 8 days on average), and Strategy 3 considers that 10% of the population is immune on day 1 (<span class="math inline">\(S_1=90{,}000\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/unnamed-chunk-5-1.png" width="95%" style="display: block; margin: auto;" /></p>
</div>
<p>Social distancing policies, limitations on group sizes, and quarantines are used to reduce the transmission rate (decrease <span class="math inline">\(\beta\)</span>). This action has been taken by most governments around the world to limit the number of people who are infected and results in a “flattening of the curve” as shown by Strategy 1 in the plot. This strategy forces the peak down (and therefore reduces hospital overcrowding), but extends the total outbreak duration. As can be seen from the cumulative plot on the right, it also reduces the total percentage of the population that will be infected.</p>
<p>The second strategy is to reduce the time someone is infectious (increase <span class="math inline">\(\gamma\)</span>). This could be accomplished by medications, supplements, nutrition, exercise, and other treatments. <a href="https://www.niaid.nih.gov/news-events/nih-clinical-trial-shows-remdesivir-accelerates-recovery-advanced-covid-19">Remdesivir, for example, may reduce the infectious period for up to 4 days on average</a>. In this hypothetical scenario, the SIR model suggests that even a 2 day reduction in the time someone is infectious can have a large impact in the peak number of infections and total number of people infected.</p>
<p>The third strategy is to reduce the susceptible population. This refers to a vaccine, which doesn’t yet exist for COVID-19. According to this SIR model a 10% vaccination rate would not only lead to a reduction in the peak infectious count but also provide the largest reduction in total number of infections (out the three scenarios).</p>
<p>Hopefully, this sheds some light on the different public health responses you have been hearing about in the headlines. There are more variations on the types of mitigation efforts available and certainly better models in which to evaluate how such efforts will impact the disease, but these three strategies and the basic SIR model will take you far in understanding how it all works.</p>
<h1 id="where-to-go-from-here">Where to go from here</h1>
<p>The purpose of this article is to provide a brief introduction to the SIR model and explain a few of its properties. Hopefully this has cleared up some of the confusion surrounding terms you have been hearing about in the news and also given you a bit more insight into how a compartmental epidemic model works. It may have also left you with other questions and concerns; I’ll outline a few thoughts on where to go next.</p>
<p>The first thing worth mentioning is that the SIR model is undoubtedly wrong in the sense that it doesn’t explain all the complexities and dynamics in the COVID-19 pandemic. But as <a href="https://en.wikipedia.org/wiki/All_models_are_wrong">George Box famously said</a> “All models are wrong, but some are useful”. And the SIR model can be useful in many ways. First, it is a good starting place for understanding the more complex models. Also, never forget that the parameters of these models must be estimated. A simple model can provide better predictions than a more realistic (and complex) model when there is not enough data or the data quality is poor. And we are dealing with both sparsity and quality issues in the COVID-19 data. This is an often under-appreciated aspect of modeling and data analysis.</p>
<p>Nevertheless, I’d say the basic SIR model is too simplistic to be used for accurate modeling of the COVID pandemic. Fortunately, there are several relatively simple ways to improve it. First, we can consider that the transmission parameter <span class="math inline">\(\beta\)</span> (and hence <span class="math inline">\(R_0\)</span>) can change over time, especially due to social distancing and stay at home regulations. I would be skeptical of any COVID-19 model that didn’t account for changes in the transmission rate, especially with the unprecedented movement restrictions we have seen around the world. Here is a simple analysis that shows how the infectious counts respond if the transmission parameter <span class="math inline">\(\beta\)</span> is abruptly changed during the course of the epidemic.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/unnamed-chunk-7-1.png" width="85%" style="display: block; margin: auto;" /></p>
</div>
<p>The baseline scenario is the same as what was considered in <a href="#dynamics">Changing the Disease Dynamics section</a>, <span class="math inline">\(\beta=0.30, \gamma=1/10\)</span> (<span class="math inline">\(R_0 = 3.0\)</span>). The other scenarios consider that <span class="math inline">\(\beta\)</span> is reduced to <span class="math inline">\(0.20\)</span> on a certain day (e.g., due to a shelter in place order). The top left panel is the baseline scenario. The other panels show how the infectious rate varies if the intervention occurs at different time points in the course of the epidemic. The black line is provided as a reference to the baseline scenario. These plots reveal that early changes in the transmission rate have the strongest effect. A change close to the herd immunity induced peak (bottom right panel) has very little effect.</p>
<p>The basic SIR model is deterministic. This means that once the model parameters (<span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>) are specified there is no randomness in the model output. This is apparent by considering that all transitions between compartments are specified by expected values and not probability distributions. One consequence of this is that no uncertainty is represented in the model output - something that can lead to poor decision making. Uncertainty in the model output can be estimated with Monte Carlo simulation of a <em>stochastic</em> SIR model. In a stochastic SIR, instead of modeling exactly <span class="math inline">\(f_t S_t\)</span> newly infectious on day <span class="math inline">\(t+1\)</span>, the number of newly infectious is randomly determined according to a <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial distribution</a> (<span class="math inline">\(\text{Bino}(n=S_t, p=f_t)\)</span>). Likewise, the number of infectious people that recover is no longer exactly <span class="math inline">\(\gamma I_t\)</span>, but randomly determined according to the <a href="https://en.wikipedia.org/wiki/Binomial_distribution">Binomial distribution</a> (<span class="math inline">\(\text{Bino}(n=I_t, p=\gamma)\)</span>). The stochastic SIR will produce a different set of curves every time it is simulated. To get a sense of the uncertainty, the stochastic SIR can be simulated 100’s or 1000’s of times. For example, below is the result of running a stochastic version of the SIR model 100 times.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/unnamed-chunk-8-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Notice that while the peak number of infectious is very consistent (around 31.2K), the timing of the peak has much greater variability, starting as early as day 58 in one simulation and including one simulation that doesn’t reach the peak until day 93. A word of caution: the stochastic SIR only addresses the uncertainty in the model output, but doesn’t address the uncertainty in estimating the model parameters (i.e., it assumes <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> are known exactly). Parameter uncertainty, especially early in the outbreak when data is limited, will have an even greater influence on how precisely we can make predictions. Making decisions under uncertainty is the rule rather than the exception for this pandemic!</p>
<p>There are <a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology">many other compartmental models</a> that extend SIR. The closest is the SEIR model that splits out the infected population into two sub-groups, those who are infected but not yet contagious and those who are infectious. The SEIR model is very similar to the SIR model, but <font color="#377eb8">Susceptible</font> people who become infected move first move into the <font color="#984ea3">Exposed</font> group. There is one additional parameter that controls how long a person stays in the <font color="#984ea3">Exposed</font> group before they move into the <font color="#e41a1c">Infectious</font> state.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="to-sir-with-love_files/figure-html5/unnamed-chunk-10-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<p>The basic framework can be extended to include more detailed compartments and transitions, like having separate parameters for different age groups or how likely people from different geographic locations will interact, etc. For very complex model specifications, <a href="https://www.sciencedirect.com/science/article/pii/S1755436517300221">Agent-Based Models (ABM)</a> can be employed to understand the corresponding disease dynamics. You can think of an ABM as a type of stochastic compartmental model on steroids; it can capture very complex population behavior using agents that follow relatively simple rules (e.g., leave home between 8-9am, go to work, stop for groceries once per week, go out to eat 2 times per week) and can have individual disease progression (e.g., an older agent has higher probability of becoming hospitalized).</p>
<p>I’ll close this article with mention of an all together different way to estimate epi-curves is with a pattern-based or curve fitting approach. This is the approach taken by <a href="https://covid19.healthdata.org/united-states-of-america">Institute for Health Metrics and Evaluation</a> and is based on the observation that over a wide range of parameter values, the SIR/SEIR models maintain a similar <em>shape</em>. For example, notice from the plots above that the curves representing the number/percentage of infectious people look rather bell-shaped. For those of you who have taken a Statistics course, the mention of “bell-shaped” will evoke the wonderful memories of the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a> and the <a href="https://en.wikipedia.org/wiki/Normal_distribution">Gaussian or Normal distribution</a>. The <a href="%5D(https://ihmeuw-msca.github.io/CurveFit/methods/)">IHME modelers</a> exploit this observation and directly estimate the parameters of a <a href="https://en.wikipedia.org/wiki/Gaussian_function">Gaussian shaped</a> epi-curve. This approach offers a different way to estimate model parameters (e.g., using fatality data) with a focus on forecasting.</p>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/mdporter/blog/issues/new">create an issue</a> on the source repository.</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
